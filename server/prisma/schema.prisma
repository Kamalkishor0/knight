// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                String       @id @default(cuid())
  username          String       @unique
  email             String       @unique
  password          String
  createdAt         DateTime     @default(now())
  updatedAt         DateTime     @updatedAt
  sentFriendships   Friendship[] @relation("FriendshipRequester")
  receivedFriendships Friendship[] @relation("FriendshipAddressee")
}

model Friendship {
  id          String           @id @default(cuid())
  requesterId String
  addresseeId String
  status      FriendshipStatus @default(PENDING)
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  respondedAt DateTime?

  requester User @relation("FriendshipRequester", fields: [requesterId], references: [id], onDelete: Cascade)
  addressee User @relation("FriendshipAddressee", fields: [addresseeId], references: [id], onDelete: Cascade)

  @@unique([requesterId, addresseeId])
  @@index([addresseeId, status])
  @@index([requesterId, status])
}

enum FriendshipStatus {
  PENDING
  ACCEPTED
  REJECTED
}

